<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
	<!-- You can reuse expressions for conditions by defining them once -->
	<extension point="org.eclipse.core.expressions.definitions">
		<definition id="eu.jsparrow.ui.filter.menuItemFilter">
			<with variable="activeMenuSelection">
				<iterate ifEmpty="false">
					<and>
						<adapt type="org.eclipse.core.resources.IResource">
							<test property="org.eclipse.core.resources.projectNature"
								value="org.eclipse.jdt.core.javanature">
							</test>
						</adapt>
						<or>
							<adapt type="org.eclipse.jdt.core.IJavaProject" />
							<adapt type="org.eclipse.core.resources.IProject" />
							<adapt type="org.eclipse.jdt.core.IPackageFragment" />
							<adapt type="org.eclipse.jdt.core.IPackageFragmentRoot" />
							<adapt type="org.eclipse.jdt.core.ICompilationUnit" />
						</or>
					</and>
				</iterate>
			</with>
		</definition>
	</extension>

	<extension point="org.eclipse.ui.menus">
		<menuContribution
			locationURI="popup:org.eclipse.jdt.ui.PackageExplorer?after=org.eclipse.jdt.ui.refactoring.menu">
			<menu icon="icons/jSparrow_active_icon_16.png" id="jsparrow.menu"
				label="%menu.label">
				<visibleWhen>
					<reference definitionId="eu.jsparrow.ui.filter.menuItemFilter">
					</reference>
				</visibleWhen>
				<command commandId="eu.jsparrow.ui.SelectRulesWizardHandler"
					label="%command.label.select_rules_wizard" style="push" />
				<command commandId="eu.jsparrow.ui.LoggerRuleWizardHandler"
					label="%command.label.logger_rule_wizard" style="push" />
				<command commandId="eu.jsparrow.ui.RenameFieldsRuleWizardHandler"
					label="%command.label.rename_fields_rule_wizard" style="push" />
			</menu>
		</menuContribution>
		<menuContribution
			locationURI="popup:org.eclipse.ui.navigator.ProjectExplorer#PopupMenu?after=org.eclipse.jdt.ui.refactoring.menu">
			<menu icon="icons/jSparrow_active_icon_16.png" label="%menu.label">
				<command commandId="eu.jsparrow.ui.SelectRulesWizardHandler"
					label="%command.label.select_rules_wizard" style="push" />
				<command commandId="eu.jsparrow.ui.LoggerRuleWizardHandler"
					label="%command.label.logger_rule_wizard" style="push" />
				<command commandId="eu.jsparrow.ui.RenameFieldsRuleWizardHandler"
					label="%command.label.rename_fields_rule_wizard" style="push" />
				<visibleWhen>
					<reference definitionId="eu.jsparrow.ui.filter.menuItemFilter">
					</reference>

				</visibleWhen>
			</menu>
		</menuContribution>
		<menuContribution
			locationURI="popup:#CompilationUnitEditorContext?after=org.eclipse.jdt.ui.refactoring.menu">
			<menu icon="icons/jSparrow_active_icon_16.png" label="%menu.label">
				<command commandId="eu.jsparrow.ui.SelectRulesWizardHandler"
					label="%command.label.select_rules_wizard" style="push" />
				<command commandId="eu.jsparrow.ui.LoggerRuleWizardHandler"
					label="%command.label.logger_rule_wizard" style="push" />
				<command commandId="eu.jsparrow.ui.RenameFieldsRuleWizardHandler"
					label="%command.label.rename_fields_rule_wizard" style="push" />
			</menu>
		</menuContribution>
	</extension>
	<extension point="org.eclipse.ui.commands">
		<command defaultHandler="eu.jsparrow.ui.handler.SelectRulesWizardHandler"
			id="eu.jsparrow.ui.SelectRulesWizardHandler" name="%command.name.select_rules_wizard_handler" />
		<command defaultHandler="eu.jsparrow.ui.handler.LoggerRuleWizardHandler"
			id="eu.jsparrow.ui.LoggerRuleWizardHandler" name="%command.name.logger_rule_wizard_handler" />
		<command defaultHandler="eu.jsparrow.ui.handler.RenameFieldsRuleWizardHandler"
			id="eu.jsparrow.ui.RenameFieldsRuleWizardHandler" name="%command.name.rename_fields_wizard_handler" />
		<command defaultHandler="eu.jsparrow.ui.handler.WelcomeHandler"
           id="eu.jsparrow.ui.handler.WelcomeHandler" name="jSparrow Dashboard" />
	</extension>
	<extension point="org.eclipse.ui.preferencePages">
		<page class="eu.jsparrow.ui.preference.SimonykeesPreferencePage"
			id="eu.jsparrow.ui.preference.ProfilePreferencePage" name="%preferencePage.name" />
		<page category="eu.jsparrow.ui.preference.ProfilePreferencePage"
			class="eu.jsparrow.ui.preference.SimonykeesPreferencePageLicense" id="eu.jsparrow.ui.preference.ProfilePreferencePageLicense"
			name="%preferencePageLicense.name" />
	</extension>
	<extension point="org.eclipse.core.runtime.preferences">
		<initializer
			class="eu.jsparrow.ui.preference.SimonykeesPreferenceInitializer" />
	</extension>
	<extension point="org.eclipse.epp.logging.aeri.ide.servers">
		<server
			class="org.eclipse.epp.internal.logging.aeri.ide.server.mars.ServerConnection"
			description="Help improve jSparrow by sending error reports to us."
			icon16="icons/jSparrow_active_icon_16.png" icon32="icons/jSparrow_active_icon_32.png"
			id="at.splendit.jsparrow" name="jSparrow">
			<link href="https://jsparrow.eu/" rel="provider" title="jSparrow" />
			<link href="https://aer.ctrlflow.com/jsparrow/community/discovery"
				rel="discovery" title="Discovery URL" />
		</server>
	</extension>
	<extension point="org.eclipse.ui.startup">
		<startup class="eu.jsparrow.ui.startup.Startup" />
	</extension>
	
	<extension point="org.eclipse.ui.editors">
		<editor
			class="eu.jsparrow.ui.startup.WelcomeEditor"
			icon="$nl$/icons/jSparrow_active_icon_16.png"
			id="ui.editors.jsparrow.WelcomeEditor"
			name="jSparrow Dashboard">
		</editor>
	</extension>
	 
 	<extension point="org.eclipse.ui.elementFactories">
    	<factory
          class="eu.jsparrow.ui.startup.WelcomeEditorInputFactory"
          id="eu.jsparrow.ui.startup.elementFactory">
    	</factory>
 	</extension>
 	
 	  <extension
        point="org.eclipse.ui.menus">
     <menuContribution
           allPopups="false"
           locationURI="toolbar:org.eclipse.ui.main.toolbar">
        <toolbar
              id="eu.jsparrow.ui.startup.toolbar"
              label="jSparrow Dashboard">
           <command
                 commandId="eu.jsparrow.ui.handler.WelcomeHandler"
                 icon="$nl$/icons/jSparrow_active_icon_16.png"
                 label="jSparrow Dashboard"
                 style="push">
           </command>
        </toolbar>
     </menuContribution>
  </extension>
  
</plugin>
